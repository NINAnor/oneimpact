<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prediction of a bag of models to new data — predict • oneimpact</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction of a bag of models to new data — predict"><meta name="description" content="The function predict makes a prediction for new data based wither on a bag of models or
on its formula, coefficients, and weights. The prediction can be made either for a complete new dataset
with all the variables included in the formula or to predict the specific response on one single or a
group of variables in the model. In this case, all the other variables are set to their median or mean
value, to to zero (defined by the baseline parameter). What controls that is which columns are added in
the newdata data.frame."><meta property="og:description" content="The function predict makes a prediction for new data based wither on a bag of models or
on its formula, coefficients, and weights. The prediction can be made either for a complete new dataset
with all the variables included in the formula or to predict the specific response on one single or a
group of variables in the model. In this case, all the other variables are set to their median or mean
value, to to zero (defined by the baseline parameter). What controls that is which columns are added in
the newdata data.frame."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oneimpact</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/oneimpact.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/oneimpact.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/computing_zoi.html">Computing zones of influence</a></li>
    <li><a class="dropdown-item" href="../articles/zoi_on_grass.html">Zones of influence on GRASS GIS</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NINAnor/oneimpact/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prediction of a bag of models to new data</h1>
      <small class="dont-index">Source: <a href="https://github.com/NINAnor/oneimpact/blob/main/R/bag_predict.R" class="external-link"><code>R/bag_predict.R</code></a></small>
      <div class="d-none name"><code>predict.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>predict</code> makes a prediction for new data based wither on a bag of models or
on its formula, coefficients, and weights. The prediction can be made either for a complete new dataset
with all the variables included in the formula or to predict the specific response on one single or a
group of variables in the model. In this case, all the other variables are set to their median or mean
value, to to zero (defined by the <code>baseline</code> parameter). What controls that is which columns are added in
the <code>newdata</code> data.frame.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predict</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"exponential"</span>, <span class="st">"exp"</span>, <span class="st">"logit"</span>, <span class="st">"cloglog"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  wmean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  wq_probs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'bag'</span></span>
<span><span class="fu">predict</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"exponential"</span>, <span class="st">"exp"</span>, <span class="st">"logit"</span>, <span class="st">"cloglog"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  wmean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  wq_probs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  baseline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"median"</span>, <span class="st">"mean"</span>, <span class="st">"zero"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  zoi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  zoi_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp_decay"</span>, <span class="st">"gaussian_decay"</span>, <span class="st">"linear_decay"</span>, <span class="st">"threshold_decay"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  which_cumulative <span class="op">=</span> <span class="st">"cumulative"</span>,</span>
<span>  type_feature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"point"</span>, <span class="st">"line"</span>, <span class="st">"area"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  n_features <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  line_value <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">predict</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  <span class="va">coefs</span>,</span>
<span>  weights <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"exponential"</span>, <span class="st">"exp"</span>, <span class="st">"logit"</span>, <span class="st">"cloglog"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  wmean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  wq_probs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>[bag,list or formula]</code> <br>  A bag of models, resulting from a call to <code><a href="bag_models.html">bag_models()</a></code>,
or a <code>formula</code> used to fit the models in the bag.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p><br> New data set to be used for prediction. It can include all the variables in the formula
or only those for which the user is interested in making a prediction from.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p><code>[character="linear"]{"linear", "exponential", "exp", "logit", "cloglog"}</code> <br> Type of prediction.
One of <code>"linear"</code> (default), <code>"exp"</code> or <code>"exponential"</code>, <code>"logit"</code>, or <code>"cloglog"</code>.</p></dd>


<dt id="arg-wmean">wmean<a class="anchor" aria-label="anchor" href="#arg-wmean"></a></dt>
<dd><p><code>[logical=TRUE]</code> <br> Should the weighted mean values be predicted? Default is <code>TRUE</code>.</p></dd>


<dt id="arg-wq-probs">wq_probs<a class="anchor" aria-label="anchor" href="#arg-wq-probs"></a></dt>
<dd><p><code>[vector,numeric(3)=c(0.025, 0.5, 0.975)]</code> <br> A three element vector with lower,
mid, and higher weighted quantiles to be computed.</p></dd>


<dt id="arg-include">include<a class="anchor" aria-label="anchor" href="#arg-include"></a></dt>
<dd><p><code>[character="all"]</code> <br> String of vector of strings with the terms (or unique parts of terms)
to be predicted for. This does not restrict which terms we are focusing on - this is done
by the definition of the <code>newdata</code> dataset and by which columns are in there. What
the <code>include</code> parameters does is to set which other variables will be used for prediction,
at their mean or median values, for instance.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p><br> Additional parameters. None implemented.</p></dd>


<dt id="arg-baseline">baseline<a class="anchor" aria-label="anchor" href="#arg-baseline"></a></dt>
<dd><p><code>[character="median"]{"median", "mean", "zero")}</code> <br> What values to
choose for the baseline, i.e., for all other variables/terms not contained in
<code>newdata</code>. It can be one of <code>median</code>, <code>"mean"</code>, or <code>"zero"</code>.</p></dd>


<dt id="arg-zoi">zoi<a class="anchor" aria-label="anchor" href="#arg-zoi"></a></dt>
<dd><p><code>[logical(1)=FALSE]</code> <br> Are the columns in <code>newdata</code> supposed to represent
zones of influence (ZOI) variables?
This parameter should be set to <code>TRUE</code> if you provided a set of distances from a source that need
to be translated into ZOI variables (cumulative or nearest ZOI from sources).</p></dd>


<dt id="arg-zoi-shape">zoi_shape<a class="anchor" aria-label="anchor" href="#arg-zoi-shape"></a></dt>
<dd><p><code>[character="exp_decay"]{"exp_decay", "gaussian_decay", "linear_decay", "threshold_decay"}</code> <br>
Shape of the zone of influence (ZOI), if <code>zoi = TRUE</code>. Default is <code>exp_decay"</code>. It can assume any of the
possible values for the argument <code>type</code> in the function <code><a href="zoi_functions.html">dist_decay()</a></code>.</p></dd>


<dt id="arg-which-cumulative">which_cumulative<a class="anchor" aria-label="anchor" href="#arg-which-cumulative"></a></dt>
<dd><p><code>[character="cumulative"]</code> <br> Which string or pattern to be searched on the column
names of <code>newdata</code> and on the original data used to fit the models to represent the cumulative ZOI.
It is used to break the names of the columns/terms in the formula and get the ZOI radii as numbers,
to be able to create all the ZOI radii included in the model or bag of models.</p></dd>


<dt id="arg-type-feature">type_feature<a class="anchor" aria-label="anchor" href="#arg-type-feature"></a></dt>
<dd><p><code>[character="point"]{"point", "line", "area"}</code> <br> Type of feature we are predicting
for, for zone of influence-type variables. Default is <code>"point"</code>. If <code>type_feature = "line"</code>, a line is simulated
with the function <code><a href="create_linear_feature_zoi.html">create_linear_feature_zoi()</a></code> to get the values and account for
the number of pixels of each single linear feature in the neighborhhod and correclty estimate
the effect of each linear feature ZOI. The option <code>"area"</code> is still not implemented and for now
is treated as a point feature at the origin.</p></dd>


<dt id="arg-n-features">n_features<a class="anchor" aria-label="anchor" href="#arg-n-features"></a></dt>
<dd><p><code>[numeric(1)=1]</code> <br> Number of features to be used for prediction, for ZOI variables.
Default is 1.</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p><code>[numeric(1)=100]</code> <br> Resolution for the raster created in <code>create_line_feature_zoi()</code>,
when <code>type_feature = "line"</code>.</p></dd>


<dt id="arg-line-value">line_value<a class="anchor" aria-label="anchor" href="#arg-line-value"></a></dt>
<dd><p><code>[numeric(1)=1]</code> <br> Value set to the raster line created by <code>create_line_feature_zoi()</code>,
when <code>type_feature = "line"</code>. It could be changed to different values if we want to represent e.g. the value in the
linear feature as the roads traffic or another value for spatio-temporally dynamic variables.</p></dd>


<dt id="arg-coefs">coefs<a class="anchor" aria-label="anchor" href="#arg-coefs"></a></dt>
<dd><p><code>[vector,numeric]</code> <br> Either a named vector of coefficients (in case there is only one
model) or a matrix of coefficients, with rownames as the term names and columns as the different models/resamples.
Only relevant if <code>x</code> is a formula.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p><code>[vector,numeric=1]</code> <br> Vector of weights for the different models/resamples, i.e.
the column from the <code>coefs</code> object with coefficients. A single number (by default, 1) in case there is only
one model (<code>coefs</code> is a vector). Only relevant if <code>x</code> is a formula.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot_response.html">plot_response()</a></code>, <code>create_line_feature_zoi()</code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#---</span></span></span>
<span class="r-in"><span><span class="co"># fit a bag to be tested</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"reindeer_rsf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># rename it just for convenience</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">reindeer_rsf</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># formula initial structure</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="va">use</span> <span class="op">~</span> <span class="va">private_cabins_XXX</span> <span class="op">+</span> <span class="va">public_cabins_high_XXX</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="va">NORUTreclass</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="co"># poly(norway_pca_klima_axis1, 2, raw = TRUE) +</span></span></span>
<span class="r-in"><span>  <span class="co"># poly(norway_pca_klima_axis2, 2, raw = TRUE) +</span></span></span>
<span class="r-in"><span>  <span class="va">norway_pca_klima_axis1</span> <span class="op">+</span> <span class="va">norway_pca_klima_axis1_sq</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="va">norway_pca_klima_axis2</span> <span class="op">+</span> <span class="va">norway_pca_klima_axis2_sq</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="va">norway_pca_klima_axis3</span> <span class="op">+</span> <span class="va">norway_pca_klima_axis4</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add ZOI terms to the formula</span></span></span>
<span class="r-in"><span><span class="va">zois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">250</span>, <span class="fl">500</span>, <span class="fl">1000</span>, <span class="fl">2500</span>, <span class="fl">5000</span>, <span class="fl">10000</span>, <span class="fl">20000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_zoi_formula.html">add_zoi_formula</a></span><span class="op">(</span><span class="va">f</span>, zoi_radius <span class="op">=</span> <span class="va">zois</span>, pattern <span class="op">=</span> <span class="st">"XXX"</span>,</span></span>
<span class="r-in"><span>                     type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cumulative_exp_decay"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     separator <span class="op">=</span> <span class="st">"_"</span>, predictor_table <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">formula</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sampling - random sampling</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_resamples.html">create_resamples</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">use</span>,</span></span>
<span class="r-in"><span>                            p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            times <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                            colH0 <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Starting random sampling..."</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit multiple models</span></span></span>
<span class="r-in"><span><span class="va">fittedl</span> <span class="op">&lt;-</span> <span class="fu"><a href="bag_fit_net_functions.html">bag_fit_net_logit</a></span><span class="op">(</span><span class="va">f</span>,</span></span>
<span class="r-in"><span>                             data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>                             samples <span class="op">=</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>                             standardize <span class="op">=</span> <span class="st">"internal"</span>, <span class="co"># glmnet does the standardization of covariates</span></span></span>
<span class="r-in"><span>                             metric <span class="op">=</span> <span class="st">"AUC"</span>,</span></span>
<span class="r-in"><span>                             method <span class="op">=</span> <span class="st">"AdaptiveLasso"</span>,</span></span>
<span class="r-in"><span>                             parallel <span class="op">=</span> <span class="st">"mclapply"</span>,</span></span>
<span class="r-in"><span>                             mc.cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># bag models in a single object</span></span></span>
<span class="r-in"><span><span class="va">bag_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="bag_models.html">bag_models</a></span><span class="op">(</span><span class="va">fittedl</span>, <span class="va">dat</span>, score_threshold <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#---</span></span></span>
<span class="r-in"><span><span class="co"># prediction using formula</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># new data, looking only at PCA1</span></span></span>
<span class="r-in"><span><span class="va">dfvar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>norway_pca_klima_axis1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">bag_object</span><span class="op">$</span><span class="va">data_summary</span><span class="op">$</span><span class="va">norway_pca_klima_axis1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                                <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">bag_object</span><span class="op">$</span><span class="va">data_summary</span><span class="op">$</span><span class="va">norway_pca_klima_axis1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                                length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dfvar</span><span class="op">$</span><span class="va">norway_pca_klima_axis1_sq</span> <span class="op">=</span> <span class="va">dfvar</span><span class="op">$</span><span class="va">norway_pca_klima_axis1</span><span class="op">**</span><span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># one model only</span></span></span>
<span class="r-in"><span><span class="fu">bag_predict</span><span class="op">(</span>x <span class="op">=</span> <span class="va">f</span>,</span></span>
<span class="r-in"><span>            newdata <span class="op">=</span> <span class="va">dfvar</span>,</span></span>
<span class="r-in"><span>            coefs <span class="op">=</span> <span class="va">bag_object</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            include <span class="op">=</span> <span class="st">"axis1"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bag_predict(x = f, newdata = dfvar, coefs = bag_object$coef[,     1], include = "axis1"):</span> could not find function "bag_predict"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># whole bag, weighted mean - here all weights = 1</span></span></span>
<span class="r-in"><span><span class="fu">bag_predict</span><span class="op">(</span>x <span class="op">=</span> <span class="va">f</span>,</span></span>
<span class="r-in"><span>            newdata <span class="op">=</span> <span class="va">dfvar</span>,</span></span>
<span class="r-in"><span>            coefs <span class="op">=</span> <span class="va">bag_object</span><span class="op">$</span><span class="va">coef</span>,</span></span>
<span class="r-in"><span>            include <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dfvar</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bag_predict(x = f, newdata = dfvar, coefs = bag_object$coef,     include = names(dfvar)):</span> could not find function "bag_predict"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># whole bag, for each model separately</span></span></span>
<span class="r-in"><span><span class="fu">bag_predict</span><span class="op">(</span>x <span class="op">=</span> <span class="va">f</span>,</span></span>
<span class="r-in"><span>            newdata <span class="op">=</span> <span class="va">dfvar</span>,</span></span>
<span class="r-in"><span>            coefs <span class="op">=</span> <span class="va">bag_object</span><span class="op">$</span><span class="va">coef</span>,</span></span>
<span class="r-in"><span>            wmean <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>            include <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dfvar</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bag_predict(x = f, newdata = dfvar, coefs = bag_object$coef,     wmean = FALSE, include = names(dfvar)):</span> could not find function "bag_predict"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#---</span></span></span>
<span class="r-in"><span><span class="co"># prediction using bag</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># prediction for the very same dataset, linear scale</span></span></span>
<span class="r-in"><span><span class="fu">bag_predict</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bag_object</span>,</span></span>
<span class="r-in"><span>            newdata <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>            data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bag_predict(x = bag_object, newdata = dat, data = dat):</span> could not find function "bag_predict"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># non ZOI variable</span></span></span>
<span class="r-in"><span><span class="co"># new data, looking only at PCA3</span></span></span>
<span class="r-in"><span><span class="va">dfvar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>norway_pca_klima_axis3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">bag_object</span><span class="op">$</span><span class="va">data_summary</span><span class="op">$</span><span class="va">norway_pca_klima_axis3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                                <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">bag_object</span><span class="op">$</span><span class="va">data_summary</span><span class="op">$</span><span class="va">norway_pca_klima_axis3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                                length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">bag_predict</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bag_object</span>,</span></span>
<span class="r-in"><span>            newdata <span class="op">=</span> <span class="va">dfvar</span>,</span></span>
<span class="r-in"><span>            data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bag_predict(x = bag_object, newdata = dfvar, data = dat):</span> could not find function "bag_predict"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ZOI variable</span></span></span>
<span class="r-in"><span><span class="co"># new data, looking only at private cabins</span></span></span>
<span class="r-in"><span><span class="va">dfvar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>private_cabins <span class="op">=</span> <span class="fl">1e3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">20</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># prediction for 1 feature, linear scale</span></span></span>
<span class="r-in"><span><span class="fu">bag_predict</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bag_object</span>,</span></span>
<span class="r-in"><span>            newdata <span class="op">=</span> <span class="va">dfvar</span>,</span></span>
<span class="r-in"><span>            data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>            zoi <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>            baseline <span class="op">=</span> <span class="st">"zero"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bag_predict(x = bag_object, newdata = dfvar, data = dat, zoi = TRUE,     baseline = "zero"):</span> could not find function "bag_predict"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># prediction for 30 features, exp scale, with weighted confidence intervals</span></span></span>
<span class="r-in"><span><span class="fu">bag_predict</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bag_object</span>,</span></span>
<span class="r-in"><span>            newdata <span class="op">=</span> <span class="va">dfvar</span>,</span></span>
<span class="r-in"><span>            data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>            type <span class="op">=</span> <span class="st">"exp"</span>,</span></span>
<span class="r-in"><span>            wq_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            zoi <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>            n_features <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>            baseline <span class="op">=</span> <span class="st">"zero"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bag_predict(x = bag_object, newdata = dfvar, data = dat, type = "exp",     wq_probs = c(0.025, 0.975), zoi = TRUE, n_features = 30,     baseline = "zero"):</span> could not find function "bag_predict"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfvar</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     <span class="fu">bag_predict</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bag_object</span>,</span></span>
<span class="r-in"><span>                 newdata <span class="op">=</span> <span class="va">dfvar</span>,</span></span>
<span class="r-in"><span>                 data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>                 type <span class="op">=</span> <span class="st">"exp"</span>,</span></span>
<span class="r-in"><span>                 zoi <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 n_features <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>                 baseline <span class="op">=</span> <span class="st">"zero"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'y' in selecting a method for function 'plot': could not find function "bag_predict"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bernardo Brandão Niebuhr, Manuela Panzacchi, Bram van Moorter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

